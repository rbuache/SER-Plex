package xml;

import java.util.Iterator;
import java.util.LinkedList;
import java.util.List;

import javax.swing.JOptionPane;

import jdom.util.IO;
import launcher.Launcher;

import org.jdom2.Document;
import org.jdom2.Element;

public class XmlLocation {

	private Document doc;
	
	public XmlLocation(String path){
		
		try {
			doc = IO.getDocument(path + "/location.xml");
		} catch (Exception e) {
			JOptionPane.showMessageDialog(Launcher.gui, "Path to XML Location not valid\n" + path + "/location.xml","Crash", JOptionPane.ERROR_MESSAGE);
			System.exit(-1);
		}
		
	}


	public Object[][] getLocations(){
		int count = 0;
		
		Element root = doc.getRootElement();
		List loc = root.getChildren("location");
		Iterator i = loc.iterator();
		
		Object[][] result = new Object[loc.size()][];
		while(i.hasNext()){
			Element e = (Element)i.next();
			result[count] = new Object[]{
						e.getChild("name").getText(),
						e.getChild("address").getText(),
						e.getChild("tel").getText(),
						e
						};
			count++;
			System.out.println(e.getChild("rooms").getChildText("name"));
		}
		return result;
	}
	public void updateLocation(Element e){
		
	}
	public void createLocation(){
		
	}
	public void deleteLocation(Element e){
		//e.getParent().removeContent(e.get)
	}
	public Object[][] getRooms(Element e){
		int count = 0;
		List room = e.getChildren("rooms");
		Iterator i = room.iterator();
		
		Object[][] result = new Object[room.size()][];
		while(i.hasNext()){
			Element tmp = (Element)i.next();
			result[count] = new Object[]{
					tmp.getChild("name").getText(),
					tmp.getChild("nbSeat").getText(),
					tmp
						};
			count++;
		}
		return result;
	}
}
